<!-- Filters -->
<div class="filters" style="margin-bottom: 2rem;">
    <form action="/admin/reservations" method="GET">
        <div class="filters-row">
            <div class="form-group">
                <label class="form-label">Search</label>
                <input type="text" name="search" class="form-control" placeholder="Guest name, email, or hostel..."
                    value="<%= filters.search || '' %>">
            </div>

            <div class="form-group">
                <label class="form-label">Status</label>
                <select name="status" class="form-control">
                    <option value="all">All Status</option>
                    <option value="pending" <%=filters.status==='pending' ? 'selected' : '' %>>Pending</option>
                    <option value="confirmed" <%=filters.status==='confirmed' ? 'selected' : '' %>>Confirmed</option>
                    <option value="cancelled" <%=filters.status==='cancelled' ? 'selected' : '' %>>Cancelled</option>
                </select>
            </div>

            <div class="form-group" style="display: flex; gap: 0.5rem; align-items: flex-end;">
                <button type="submit" class="btn btn-primary">
                    <i data-lucide="filter"></i>
                    Filter
                </button>
                <a href="/admin/reservations" class="btn btn-ghost">Clear</a>
            </div>
        </div>
    </form>
</div>

<!-- Reservations Table -->
<% if (reservations && reservations.length> 0) { %>
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Guest</th>
                    <th>Hostel</th>
                    <th>Check-in</th>
                    <th>Check-out</th>
                    <th>Status</th>
                    <th>Booked</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <% reservations.forEach(function(r) { %>
                    <tr>
                        <td><strong>#<%= r.id %></strong></td>
                        <td>
                            <strong>
                                <%= r.guest_name %>
                            </strong>
                            <br>
                            <small style="color: var(--gray-500);">
                                <%= r.guest_email %>
                            </small>
                            <br>
                            <small style="color: var(--gray-400);">
                                <%= r.guest_phone %>
                            </small>
                        </td>
                        <td>
                            <%= r.hostel_name %>
                                <br>
                                <small style="color: var(--gray-500);">
                                    <%= r.location %>
                                </small>
                        </td>
                        <td>
                            <%= new Date(r.check_in).toLocaleDateString() %>
                        </td>
                        <td>
                            <%= new Date(r.check_out).toLocaleDateString() %>
                        </td>
                        <td>
                            <span class="badge badge-<%= r.status %>">
                                <%= r.status %>
                            </span>
                        </td>
                        <td style="color: var(--gray-500); font-size: 0.875rem;">
                            <%= new Date(r.created_at).toLocaleDateString() %>
                        </td>
                        <td>
                            <div class="actions" style="flex-wrap: wrap;">
                                <!-- Status Update -->
                                <form action="/admin/reservations/status/<%= r.id %>" method="POST"
                                    style="display: inline;">
                                    <select name="status" class="form-control"
                                        style="width: auto; padding: 0.375rem 0.5rem; font-size: 0.75rem;"
                                        onchange="this.form.submit()">
                                        <option value="pending" <%=r.status==='pending' ? 'selected' : '' %>>Pending
                                        </option>
                                        <option value="confirmed" <%=r.status==='confirmed' ? 'selected' : '' %>
                                            >Confirmed</option>
                                        <option value="cancelled" <%=r.status==='cancelled' ? 'selected' : '' %>
                                            >Cancelled</option>
                                    </select>
                                </form>

                                <!-- Delete -->
                                <form action="/admin/reservations/delete/<%= r.id %>" method="POST"
                                    style="display: inline;"
                                    onsubmit="return confirm('Are you sure you want to delete this reservation?')">
                                    <button type="submit" class="btn btn-icon btn-ghost btn-sm" title="Delete"
                                        style="color: var(--error);">
                                        <i data-lucide="trash-2" style="width: 16px; height: 16px;"></i>
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    <% }); %>
            </tbody>
        </table>
    </div>

    <p style="margin-top: 1rem; color: var(--gray-500);">
        Showing <%= reservations.length %> reservation<%= reservations.length !==1 ? 's' : '' %>
    </p>
    <% } else { %>
        <div class="empty-state" style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow);">
            <div class="empty-state-icon">ðŸ“…</div>
            <h3 class="empty-state-title">No Reservations Found</h3>
            <p class="empty-state-text">
                <% if (filters.search || filters.status) { %>
                    No reservations match your filters.
                    <% } else { %>
                        Reservations will appear here when customers book.
                        <% } %>
            </p>
            <% if (filters.search || filters.status) { %>
                <a href="/admin/reservations" class="btn btn-primary">Clear Filters</a>
                <% } %>
        </div>
        <% } %>